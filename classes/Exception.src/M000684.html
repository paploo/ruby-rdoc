<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>== (Exception)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre>/*
 *  call-seq:
 *     exc == obj   =&gt; true or false
 *  
 *  Equality---If &lt;i&gt;obj&lt;/i&gt; is not an &lt;code&gt;Exception&lt;/code&gt;, returns
 *  &lt;code&gt;false&lt;/code&gt;. Otherwise, returns &lt;code&gt;true&lt;/code&gt; if &lt;i&gt;exc&lt;/i&gt; and 
 *  &lt;i&gt;obj&lt;/i&gt; share same class, messages, and backtrace.
 */

static VALUE
exc_equal(VALUE exc, VALUE obj)
{
    VALUE mesg, backtrace;
    ID id_mesg;

    if (exc == obj) return Qtrue;
    CONST_ID(id_mesg, &quot;mesg&quot;);

    if (rb_obj_class(exc) != rb_obj_class(obj)) {
        ID id_message, id_backtrace;
        CONST_ID(id_message, &quot;message&quot;);
        CONST_ID(id_backtrace, &quot;backtrace&quot;);

        if (rb_respond_to(obj, id_message) &amp;&amp; rb_respond_to(obj, id_backtrace)) {
            mesg = rb_funcall(obj, id_message, 0, 0);
            backtrace = rb_funcall(obj, id_backtrace, 0, 0);
        }
        else {
            return Qfalse;
        }
    }
    else {
        mesg = rb_attr_get(obj, id_mesg);
        backtrace = exc_backtrace(obj);
    }

    if (!rb_equal(rb_attr_get(exc, id_mesg), mesg))
        return Qfalse;
    if (!rb_equal(exc_backtrace(exc), backtrace))
        return Qfalse;
    return Qtrue;
}</pre>
</body>
</html>
