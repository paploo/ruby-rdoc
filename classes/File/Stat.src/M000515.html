<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>inspect (File::Stat)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre>/*
 * call-seq:
 *   stat.inspect  =&gt;  string
 *
 * Produce a nicely formatted description of &lt;i&gt;stat&lt;/i&gt;.
 *
 *   File.stat(&quot;/etc/passwd&quot;).inspect
 *      #=&gt; &quot;#&lt;File::Stat dev=0xe000005, ino=1078078, mode=0100644, 
 *      #    nlink=1, uid=0, gid=0, rdev=0x0, size=1374, blksize=4096, 
 *      #    blocks=8, atime=Wed Dec 10 10:16:12 CST 2003, 
 *      #    mtime=Fri Sep 12 15:41:41 CDT 2003, 
 *      #    ctime=Mon Oct 27 11:20:27 CST 2003&gt;&quot;
 */

static VALUE
rb_stat_inspect(VALUE self)
{
    VALUE str;
    int i;
    static const struct {
        const char *name;
        VALUE (*func)(VALUE);
    } member[] = {
        {&quot;dev&quot;,            rb_stat_dev},
        {&quot;ino&quot;,            rb_stat_ino},
        {&quot;mode&quot;,    rb_stat_mode},
        {&quot;nlink&quot;,   rb_stat_nlink},
        {&quot;uid&quot;,            rb_stat_uid},
        {&quot;gid&quot;,            rb_stat_gid},
        {&quot;rdev&quot;,    rb_stat_rdev},
        {&quot;size&quot;,    rb_stat_size},
        {&quot;blksize&quot;, rb_stat_blksize},
        {&quot;blocks&quot;,  rb_stat_blocks},
        {&quot;atime&quot;,   rb_stat_atime},
        {&quot;mtime&quot;,   rb_stat_mtime},
        {&quot;ctime&quot;,   rb_stat_ctime},
    };

    struct stat* st;
    Data_Get_Struct(self, struct stat, st);
    if (!st) {
        return rb_sprintf(&quot;#&lt;%s: uninitialized&gt;&quot;, rb_obj_classname(self));
    }

    str = rb_str_buf_new2(&quot;#&lt;&quot;);
    rb_str_buf_cat2(str, rb_obj_classname(self));
    rb_str_buf_cat2(str, &quot; &quot;);

    for (i = 0; i &lt; sizeof(member)/sizeof(member[0]); i++) {
        VALUE v;

        if (i &gt; 0) {
            rb_str_buf_cat2(str, &quot;, &quot;);
        }
        rb_str_buf_cat2(str, member[i].name);
        rb_str_buf_cat2(str, &quot;=&quot;);
        v = (*member[i].func)(self);
        if (i == 2) {          /* mode */
            rb_str_catf(str, &quot;0%lo&quot;, NUM2ULONG(v));
        }
        else if (i == 0 || i == 6) { /* dev/rdev */
            rb_str_catf(str, &quot;0x%lx&quot;, NUM2ULONG(v));
        }
        else {
            rb_str_append(str, rb_inspect(v));
        }
    }
    rb_str_buf_cat2(str, &quot;&gt;&quot;);
    OBJ_INFECT(str, self);

    return str;
}</pre>
</body>
</html>
