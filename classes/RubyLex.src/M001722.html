<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>lex_int2 (RubyLex)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre>     <span class="ruby-comment cmt"># File lib/irb/ruby-lex.rb, line 528</span>
528:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">lex_int2</span>
529:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;]&quot;</span>, <span class="ruby-value str">&quot;}&quot;</span>, <span class="ruby-value str">&quot;)&quot;</span>) <span class="ruby-keyword kw">do</span>
530:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
531:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
532:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
533:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
534:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
535:     <span class="ruby-keyword kw">end</span>
536: 
537:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;:&quot;</span>) <span class="ruby-keyword kw">do</span>
538:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
539:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\s/</span>
540:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
541:         <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON</span>)
542:       <span class="ruby-keyword kw">else</span>
543:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_FNAME</span>;
544:         <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkSYMBEG</span>)
545:       <span class="ruby-keyword kw">end</span>
546:     <span class="ruby-keyword kw">end</span>
547: 
548:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;::&quot;</span>) <span class="ruby-keyword kw">do</span>
549:        <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
550: <span class="ruby-comment cmt">#      p @lex_state.id2name, @space_seen</span>
551:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@space_seen</span>
552:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
553:         <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON3</span>)
554:       <span class="ruby-keyword kw">else</span>
555:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_DOT</span>
556:         <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON2</span>)
557:       <span class="ruby-keyword kw">end</span>
558:     <span class="ruby-keyword kw">end</span>
559: 
560:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;/&quot;</span>) <span class="ruby-keyword kw">do</span>
561:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
562:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
563:         <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
564:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">'='</span>
565:         <span class="ruby-identifier">getc</span>
566:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
567:         <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkOPASGN</span>, <span class="ruby-value str">&quot;/&quot;</span>) <span class="ruby-comment cmt">#/)</span>
568:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@space_seen</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/\s/</span>
569:         <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
570:       <span class="ruby-keyword kw">else</span> 
571:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
572:         <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;/&quot;</span>) <span class="ruby-comment cmt">#/)</span>
573:       <span class="ruby-keyword kw">end</span>
574:     <span class="ruby-keyword kw">end</span>
575: 
576:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;^&quot;</span>) <span class="ruby-keyword kw">do</span>
577:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
578:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
579:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;^&quot;</span>)
580:     <span class="ruby-keyword kw">end</span>
581: 
582:     <span class="ruby-comment cmt">#       @OP.def_rules(&quot;^=&quot;) do</span>
583:     <span class="ruby-comment cmt">#   @lex_state = EXPR_BEG</span>
584:     <span class="ruby-comment cmt">#   Token(OP_ASGN, :^)</span>
585:     <span class="ruby-comment cmt">#       end</span>
586:     
587:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;,&quot;</span>) <span class="ruby-keyword kw">do</span>
588:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
589:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
590:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
591:     <span class="ruby-keyword kw">end</span>
592: 
593:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-value str">&quot;;&quot;</span>) <span class="ruby-keyword kw">do</span>
594:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
595:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
596:       <span class="ruby-keyword kw">until</span> (<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> 
597:              [<span class="ruby-constant">TkLPAREN</span>, <span class="ruby-constant">TkLBRACK</span>, <span class="ruby-constant">TkLBRACE</span>, 
598:                <span class="ruby-constant">TkfLPAREN</span>, <span class="ruby-constant">TkfLBRACK</span>, <span class="ruby-constant">TkfLBRACE</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">last</span>))
599:         <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
600:       <span class="ruby-keyword kw">end</span>
601:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
602:     <span class="ruby-keyword kw">end</span>
603: 
604:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;~&quot;</span>) <span class="ruby-keyword kw">do</span>
605:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
606:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
607:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;~&quot;</span>)
608:     <span class="ruby-keyword kw">end</span>
609: 
610:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;~@&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword kw">do</span>
611:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
612:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
613:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;~&quot;</span>)
614:     <span class="ruby-keyword kw">end</span>
615:     
616:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;(&quot;</span>) <span class="ruby-keyword kw">do</span>
617:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
618:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
619:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
620:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
621:         <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLPAREN</span>
622:       <span class="ruby-keyword kw">else</span>
623:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
624:         <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLPAREN</span>
625:       <span class="ruby-keyword kw">end</span>
626:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
627:       <span class="ruby-identifier">tk</span> = <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
628:     <span class="ruby-keyword kw">end</span>
629: 
630:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;[]&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword kw">do</span>
631:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
632:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
633:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;[]&quot;</span>)
634:     <span class="ruby-keyword kw">end</span>
635: 
636:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;[]=&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword kw">do</span>
637:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
638:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
639:       <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;[]=&quot;</span>)
640:     <span class="ruby-keyword kw">end</span>
641: 
642:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;[&quot;</span>) <span class="ruby-keyword kw">do</span>
643:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
644:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
645:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>
646:         <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACK</span>
647:       <span class="ruby-keyword kw">else</span>
648:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
649:           <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACK</span>
650:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@space_seen</span>
651:           <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACK</span>
652:         <span class="ruby-keyword kw">else</span>
653:           <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACK</span>
654:         <span class="ruby-keyword kw">end</span>
655:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
656:       <span class="ruby-keyword kw">end</span>
657:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
658:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
659:     <span class="ruby-keyword kw">end</span>
660: 
661:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;{&quot;</span>) <span class="ruby-keyword kw">do</span>
662:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
663:       <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
664:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_ARG</span>
665:         <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACE</span>
666:       <span class="ruby-keyword kw">else</span>
667:         <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACE</span>
668:       <span class="ruby-keyword kw">end</span>
669:       <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
670:       <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
671:       <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
672:     <span class="ruby-keyword kw">end</span>
673: 
674:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">'\\'</span>) <span class="ruby-keyword kw">do</span>
675:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
676:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\n&quot;</span>
677:         <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword kw">true</span>
678:         <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword kw">true</span>
679:         <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkSPACE</span>)
680:       <span class="ruby-keyword kw">else</span>
681:         <span class="ruby-identifier">ungetc</span>
682:         <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;\\&quot;</span>)
683:       <span class="ruby-keyword kw">end</span>
684:     <span class="ruby-keyword kw">end</span>
685: 
686:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">'%'</span>) <span class="ruby-keyword kw">do</span>
687:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
688:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
689:         <span class="ruby-identifier">identify_quotation</span>
690:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value str">'='</span>
691:         <span class="ruby-identifier">getc</span>
692:         <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkOPASGN</span>, <span class="ruby-identifier">:%</span>)
693:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@space_seen</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/\s/</span>
694:         <span class="ruby-identifier">identify_quotation</span>
695:       <span class="ruby-keyword kw">else</span>
696:         <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
697:         <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;%&quot;</span>) <span class="ruby-comment cmt">#))</span>
698:       <span class="ruby-keyword kw">end</span>
699:     <span class="ruby-keyword kw">end</span>
700: 
701:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">'$'</span>) <span class="ruby-keyword kw">do</span>
702:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
703:       <span class="ruby-identifier">identify_gvar</span>
704:     <span class="ruby-keyword kw">end</span>
705: 
706:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">'@'</span>) <span class="ruby-keyword kw">do</span>
707:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
708:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[\w_@]/</span>
709:         <span class="ruby-identifier">ungetc</span>
710:         <span class="ruby-identifier">identify_identifier</span>
711:       <span class="ruby-keyword kw">else</span>
712:         <span class="ruby-constant">Token</span>(<span class="ruby-value str">&quot;@&quot;</span>)
713:       <span class="ruby-keyword kw">end</span>
714:     <span class="ruby-keyword kw">end</span>
715: 
716:     <span class="ruby-comment cmt">#       @OP.def_rule(&quot;def&quot;, proc{|op, io| /\s/ =~ io.peek(0)}) do </span>
717:     <span class="ruby-comment cmt">#   |op, io|</span>
718:     <span class="ruby-comment cmt">#   @indent += 1</span>
719:     <span class="ruby-comment cmt">#   @lex_state = EXPR_FNAME</span>
720:     <span class="ruby-comment cmt"># # @lex_state = EXPR_END</span>
721:     <span class="ruby-comment cmt"># # until @rests[0] == &quot;\n&quot; or @rests[0] == &quot;;&quot;</span>
722:     <span class="ruby-comment cmt"># #   rests.shift</span>
723:     <span class="ruby-comment cmt"># # end</span>
724:     <span class="ruby-comment cmt">#       end</span>
725: 
726:     <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-value str">&quot;&quot;</span>) <span class="ruby-keyword kw">do</span>
727:       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
728:       <span class="ruby-identifier">printf</span> <span class="ruby-value str">&quot;MATCH: start %s: %s\n&quot;</span>, <span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
729:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[0-9]/</span>
730:         <span class="ruby-identifier">t</span> = <span class="ruby-identifier">identify_number</span>
731:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-value">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/[\w_]/</span>
732:         <span class="ruby-identifier">t</span> = <span class="ruby-identifier">identify_identifier</span>
733:       <span class="ruby-keyword kw">end</span>
734:       <span class="ruby-identifier">printf</span> <span class="ruby-value str">&quot;MATCH: end %s: %s\n&quot;</span>, <span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
735:       <span class="ruby-identifier">t</span>
736:     <span class="ruby-keyword kw">end</span>
737:     
738:     <span class="ruby-identifier">p</span> <span class="ruby-ivar">@OP</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
739:   <span class="ruby-keyword kw">end</span></pre>
</body>
</html>
