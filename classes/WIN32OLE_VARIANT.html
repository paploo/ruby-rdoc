<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: WIN32OLE_VARIANT [RDoc Documentation]</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }<\/style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">WIN32OLE_VARIANT</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/ext/win32ole/win32ole_c.html">

                ext/win32ole/win32ole.c

                </a>


        <br />

            </td>
        </tr>


        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>

                <a href="Object.html">

                Object

               </a>

            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">

  <div id="contextContent">

    <div id="description">
      <p>
support setproperty method much like Perl ;-)
</p>

    </div>

   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M002948">[]</a>&nbsp;&nbsp;

        <a href="#M002949">[]=</a>&nbsp;&nbsp;

        <a href="#M002943">array</a>&nbsp;&nbsp;

        <a href="#M002944">new</a>&nbsp;&nbsp;

        <a href="#M002945">value</a>&nbsp;&nbsp;

        <a href="#M002946">value=</a>&nbsp;&nbsp;

        <a href="#M002947">vartype</a>&nbsp;&nbsp;

      </div>
    </div>

  </div>

    <!-- if includes -->

    <div id="section">

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">

        <tr class="top-aligned-row context-row">
          <td class="context-item-name">Empty</td>
          <td>=</td>
          <td class="context-item-value">rb_funcall(cWIN32OLE_VARIANT, rb_intern(&quot;new&quot;), 2, Qnil, INT2FIX(VT_EMPTY))</td>

        </tr>

        <tr class="top-aligned-row context-row">
          <td class="context-item-name">Null</td>
          <td>=</td>
          <td class="context-item-value">rb_funcall(cWIN32OLE_VARIANT, rb_intern(&quot;new&quot;), 2, Qnil, INT2FIX(VT_NULL))</td>

        </tr>

        <tr class="top-aligned-row context-row">
          <td class="context-item-name">Nothing</td>
          <td>=</td>
          <td class="context-item-value">rb_funcall(cWIN32OLE_VARIANT, rb_intern(&quot;new&quot;), 2, Qnil, INT2FIX(VT_DISPATCH))</td>

        </tr>

        </table>
      </div>
    </div>




    <!-- if method_list -->

    <div id="methods">

      <h3 class="section-bar">Public Class methods</h3>


      <div id="method-M002943" class="method-detail">
        <a name="M002943"></a>

        <div class="method-heading">

          <a href="WIN32OLE_VARIANT.src/M002943.html" target="Code" class="method-signature"
            onclick="popupCode('WIN32OLE_VARIANT.src/M002943.html');return false;">

          <span class="method-name">WIN32OLE_VARIANT.array(ary, vt)<br />
</span>

          </a>

        </div>

        <div class="method-description">

          <p>
Returns Ruby object wrapping OLE variant whose variant type is VT_ARRAY.
The first argument should be <a href="Array.html">Array</a> object which
specifies dimensions and each size of dimensions of OLE array. The second
argument specifies variant type of the element of OLE array.
</p>
<p>
The following create 2 dimensions OLE array. The first dimensions size is
3, and the second is 4.
</p>
<pre>
   ole_ary = WIN32OLE_VARIANT.array([3,4], VT_I4)
   ruby_ary = ole_ary.value # =&gt; [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]
</pre>

        </div>
      </div>


      <div id="method-M002944" class="method-detail">
        <a name="M002944"></a>

        <div class="method-heading">

          <a href="WIN32OLE_VARIANT.src/M002944.html" target="Code" class="method-signature"
            onclick="popupCode('WIN32OLE_VARIANT.src/M002944.html');return false;">

          <span class="method-name">WIN32OLE_VARIANT.new(val, vartype) #=> WIN32OLE_VARIANT object.<br />
</span>

          </a>

        </div>

        <div class="method-description">

          <p>
Returns Ruby object wrapping OLE variant. The first argument specifies Ruby
object to convert OLE variant variable. The second argument specifies
VARIANT type. In some situation, you need the <a
href="WIN32OLE_VARIANT.html">WIN32OLE_VARIANT</a> object to pass OLE method
</p>
<pre>
   shell = WIN32OLE.new(&quot;Shell.Application&quot;)
   folder = shell.NameSpace(&quot;C:\\Windows&quot;)
   item = folder.ParseName(&quot;tmp.txt&quot;)
   # You can't use Ruby String object to call FolderItem.InvokeVerb.
   # Instead, you have to use WIN32OLE_VARIANT object to call the method.
   shortcut = WIN32OLE_VARIANT.new(&quot;Create Shortcut(\&amp;S)&quot;)
   item.invokeVerb(shortcut)
</pre>

        </div>
      </div>


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M002948" class="method-detail">
        <a name="M002948"></a>

        <div class="method-heading">

          <a href="WIN32OLE_VARIANT.src/M002948.html" target="Code" class="method-signature"
            onclick="popupCode('WIN32OLE_VARIANT.src/M002948.html');return false;">

          <span class="method-name">WIN32OLE_VARIANT[i,j,...] #=> element of OLE array.<br />
</span>

          </a>

        </div>

        <div class="method-description">

          <p>
Returns the element of <a href="WIN32OLE_VARIANT.html">WIN32OLE_VARIANT</a>
object(OLE array). This method is available only when the variant type of
<a href="WIN32OLE_VARIANT.html">WIN32OLE_VARIANT</a> object is VT_ARRAY.
</p>
<p>
REMARK:
</p>
<pre>
   The all indicies should be 0 or natural number and
   lower than or equal to max indicies.
   (This point is different with Ruby Array indicies.)

   obj = WIN32OLE_VARIANT.new([[1,2,3],[4,5,6]])
   p obj[0,0] # =&gt; 1
   p obj[1,0] # =&gt; 4
   p obj[2,0] # =&gt; WIN32OLERuntimeError
   p obj[0, -1] # =&gt; WIN32OLERuntimeError
</pre>

        </div>
      </div>


      <div id="method-M002949" class="method-detail">
        <a name="M002949"></a>

        <div class="method-heading">

          <a href="WIN32OLE_VARIANT.src/M002949.html" target="Code" class="method-signature"
            onclick="popupCode('WIN32OLE_VARIANT.src/M002949.html');return false;">

          <span class="method-name">WIN32OLE_VARIANT[i,j,...] = val #=> set the element of OLE array<br />
</span>

          </a>

        </div>

        <div class="method-description">

          <p>
<a href="Set.html">Set</a> the element of <a
href="WIN32OLE_VARIANT.html">WIN32OLE_VARIANT</a> object(OLE array) to val.
This method is available only when the variant type of <a
href="WIN32OLE_VARIANT.html">WIN32OLE_VARIANT</a> object is VT_ARRAY.
</p>
<p>
REMARK:
</p>
<pre>
   The all indicies should be 0 or natural number and
   lower than or equal to max indicies.
   (This point is different with Ruby Array indicies.)

   obj = WIN32OLE_VARIANT.new([[1,2,3],[4,5,6]])
   obj[0,0] = 7
   obj[1,0] = 8
   p obj.value # =&gt; [[7,2,3], [8,5,6]]
   obj[2,0] = 9 # =&gt; WIN32OLERuntimeError
   obj[0, -1] = 9 # =&gt; WIN32OLERuntimeError
</pre>

        </div>
      </div>


      <div id="method-M002945" class="method-detail">
        <a name="M002945"></a>

        <div class="method-heading">

          <a href="WIN32OLE_VARIANT.src/M002945.html" target="Code" class="method-signature"
            onclick="popupCode('WIN32OLE_VARIANT.src/M002945.html');return false;">

          <span class="method-name">WIN32OLE_VARIANT.value #=> Ruby object.<br />
</span>

          </a>

        </div>

        <div class="method-description">

          <p>
Returns Ruby object value from OLE variant.
</p>
<pre>
   obj = WIN32OLE_VARIANT.new(1, WIN32OLE::VARIANT::VT_BSTR)
   obj.value # =&gt; &quot;1&quot; (not Fixnum object, but String object &quot;1&quot;)
</pre>

        </div>
      </div>


      <div id="method-M002946" class="method-detail">
        <a name="M002946"></a>

        <div class="method-heading">

          <a href="WIN32OLE_VARIANT.src/M002946.html" target="Code" class="method-signature"
            onclick="popupCode('WIN32OLE_VARIANT.src/M002946.html');return false;">

          <span class="method-name">WIN32OLE_VARIANT.value = val #=> set WIN32OLE_VARIANT value to val.<br />
</span>

          </a>

        </div>

        <div class="method-description">

          <p>
Sets variant value to val. If the val type does not match variant value
type(vartype), then val is changed to match variant value type(vartype)
before setting val. Thie method is not available when vartype is
VT_ARRAY(except VT_UI1|VT_ARRAY). If the vartype is VT_UI1|VT_ARRAY, the
val should be <a href="String.html">String</a> object.
</p>
<pre>
   obj = WIN32OLE_VARIANT.new(1) # obj.vartype is WIN32OLE::VARIANT::VT_I4
   obj.value = 3.2 # 3.2 is changed to 3 when setting value.
   p obj.value # =&gt; 3
</pre>

        </div>
      </div>


      <div id="method-M002947" class="method-detail">
        <a name="M002947"></a>

        <div class="method-heading">

          <a href="WIN32OLE_VARIANT.src/M002947.html" target="Code" class="method-signature"
            onclick="popupCode('WIN32OLE_VARIANT.src/M002947.html');return false;">

          <span class="method-name">WIN32OLE_VARIANT.vartype #=> OLE variant type.<br />
</span>

          </a>

        </div>

        <div class="method-description">

          <p>
Returns OLE variant type.
</p>
<pre>
   obj = WIN32OLE_VARIANT.new(&quot;string&quot;)
   obj.vartype # =&gt; WIN32OLE::VARIANT::VT_BSTR
</pre>

        </div>
      </div>



    </div>




  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
