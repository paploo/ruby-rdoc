<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>get_class_method_choice (RDoc::RI::DefaultDisplay)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre>     <span class="ruby-comment cmt"># File lib/rdoc/ri/display.rb, line 128</span>
128:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_class_method_choice</span>(<span class="ruby-identifier">method_map</span>)
129:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">CAN_USE_READLINE</span>
130:       <span class="ruby-comment cmt"># prepare abbreviations for tab completion</span>
131:       <span class="ruby-identifier">abbreviations</span> = <span class="ruby-identifier">method_map</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">abbrev</span>
132:       <span class="ruby-constant">Readline</span>.<span class="ruby-identifier">completion_proc</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">string</span><span class="ruby-operator">|</span> 
133:         <span class="ruby-identifier">abbreviations</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">grep</span>(<span class="ruby-node">/^#{string}/</span>)
134:       <span class="ruby-keyword kw">end</span>
135:     <span class="ruby-keyword kw">end</span>
136:     
137:     <span class="ruby-ivar">@formatter</span>.<span class="ruby-identifier">raw_print_line</span> <span class="ruby-value str">&quot;\nEnter the method name you want.\n&quot;</span>
138:     <span class="ruby-ivar">@formatter</span>.<span class="ruby-identifier">raw_print_line</span> <span class="ruby-value str">&quot;Class methods can be preceeded by '::' and instance methods by '#'.\n&quot;</span>
139: 
140:     <span class="ruby-keyword kw">if</span> <span class="ruby-constant">CAN_USE_READLINE</span>
141:       <span class="ruby-ivar">@formatter</span>.<span class="ruby-identifier">raw_print_line</span> <span class="ruby-value str">&quot;You can use tab to autocomplete.\n&quot;</span>
142:       <span class="ruby-ivar">@formatter</span>.<span class="ruby-identifier">raw_print_line</span> <span class="ruby-value str">&quot;Enter a blank line to exit.\n&quot;</span>
143:       
144:       <span class="ruby-identifier">choice_string</span> = <span class="ruby-constant">Readline</span>.<span class="ruby-identifier">readline</span>(<span class="ruby-value str">&quot;&gt;&gt; &quot;</span>).<span class="ruby-identifier">strip</span>
145:     <span class="ruby-keyword kw">else</span>
146:       <span class="ruby-ivar">@formatter</span>.<span class="ruby-identifier">raw_print_line</span> <span class="ruby-value str">&quot;Enter a blank line to exit.\n&quot;</span>
147:       <span class="ruby-ivar">@formatter</span>.<span class="ruby-identifier">raw_print_line</span> <span class="ruby-value str">&quot;&gt;&gt; &quot;</span>
148:       <span class="ruby-identifier">choice_string</span> = <span class="ruby-identifier">$stdin</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">strip</span>
149:     <span class="ruby-keyword kw">end</span>
150:     
151:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">choice_string</span> <span class="ruby-operator">==</span> <span class="ruby-value str">''</span>
152:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
153:     <span class="ruby-keyword kw">else</span>
154:       <span class="ruby-identifier">class_or_instance</span> = <span class="ruby-identifier">method_map</span>[<span class="ruby-identifier">choice_string</span>]
155: 
156:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">class_or_instance</span>
157:         <span class="ruby-comment cmt"># If the user's choice is not preceeded by a '::' or a '#', figure</span>
158:         <span class="ruby-comment cmt"># out whether they want a class or an instance method and decorate</span>
159:         <span class="ruby-comment cmt"># the choice appropriately.</span>
160:         <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">choice_string</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^[a-zA-Z]/</span>)
161:           <span class="ruby-keyword kw">if</span>(<span class="ruby-identifier">class_or_instance</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:class</span>)
162:             <span class="ruby-identifier">choice_string</span> = <span class="ruby-node">&quot;::#{choice_string}&quot;</span>
163:           <span class="ruby-keyword kw">else</span>
164:             <span class="ruby-identifier">choice_string</span> = <span class="ruby-node">&quot;##{choice_string}&quot;</span>
165:           <span class="ruby-keyword kw">end</span>
166:         <span class="ruby-keyword kw">end</span>
167: 
168:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">choice_string</span>
169:       <span class="ruby-keyword kw">else</span>
170:         <span class="ruby-ivar">@formatter</span>.<span class="ruby-identifier">raw_print_line</span> <span class="ruby-node">&quot;No method matched '#{choice_string}'.\n&quot;</span>
171:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
172:       <span class="ruby-keyword kw">end</span>
173:     <span class="ruby-keyword kw">end</span>
174:   <span class="ruby-keyword kw">end</span></pre>
</body>
</html>
