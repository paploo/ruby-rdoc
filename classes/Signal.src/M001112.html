<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>new (Signal)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body class="standalone-code">
  <pre>/*
 * call-seq:
 *    SignalException.new(sig)   =&gt;  signal_exception
 *
 *  Construct a new SignalException object.  +sig+ should be a known
 *  signal name, or a signal number.
 */

static VALUE
esignal_init(int argc, VALUE *argv, VALUE self)
{
    int argnum = 1;
    VALUE sig = Qnil;
    int signo;
    const char *signm;

    if (argc &gt; 0) {
        sig = rb_check_to_integer(argv[0], &quot;to_int&quot;);
        if (!NIL_P(sig)) argnum = 2;
        else sig = argv[0];
    }
    if (argc &lt; 1 || argnum &lt; argc) {
        rb_raise(rb_eArgError, &quot;wrong number of arguments (%d for %d)&quot;,
                 argc, argnum);
    }
    if (argnum == 2) {
        signo = NUM2INT(sig);
        if (signo &lt; 0 || signo &gt; NSIG) {
            rb_raise(rb_eArgError, &quot;invalid signal number (%d)&quot;, signo);
        }
        if (argc &gt; 1) {
            sig = argv[1];
        }
        else {
            signm = signo2signm(signo);
            if (signm) {
                sig = rb_sprintf(&quot;SIG%s&quot;, signm);
            }
            else {
                sig = rb_sprintf(&quot;SIG%u&quot;, signo);
            }
        }
    }
    else {
        signm = SYMBOL_P(sig) ? rb_id2name(SYM2ID(sig)) : StringValuePtr(sig);
        if (strncmp(signm, &quot;SIG&quot;, 3) == 0) signm += 3;
        signo = signm2signo(signm);
        if (!signo) {
            rb_raise(rb_eArgError, &quot;unsupported name `SIG%s'&quot;, signm);
        }
        sig = rb_sprintf(&quot;SIG%s&quot;, signm);
    }
    rb_call_super(1, &amp;sig);
    rb_iv_set(self, &quot;signo&quot;, INT2NUM(signo));

    return self;
}</pre>
</body>
</html>
